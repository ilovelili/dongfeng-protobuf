syntax = "proto3";

package dongfeng.protobuf;

// ******************************************************* core message definition *******************************************************

///////////////////////////////////////////////////
message DashboardRequest {
	string token = 1;
}

message DashboardResponse {
	string user_id = 1;
	repeated Notification notifications = 2;
}

///////////////////////////////////////////////////
message LoginRequest {
	string token = 1;
}

message LoginResponse {
	User user = 1;
}

message User {
	bool newuser = 1;
	string role = 2;
	string id = 3;
	string email = 4;
	string name = 5;
	string avatar = 6;
	repeated Setting settings = 7;
}

///////////////////////////////////////////////////
message UploadAvatarResponse {
	string uri = 1;
}

///////////////////////////////////////////////////
message Setting {
	int64 id = 1;
	string name = 2;
	bool enabled = 3;
}

///////////////////////////////////////////////////
message UpdateNotificationsRequest {
	string token = 1;
	repeated int64 notifications = 2;
}

message UpdateNotificationsResponse { }

message UpdateNotificationRequest {
	Notification notification = 1;
}

message UpdateNotificationResponse { }

message Notification {
	int64 id = 1;
	string user_id = 2;
	string custom_code = 3;
	string category = 4;
	int64 category_id = 5;
	string details = 6;
	string link = 7;
	int64 read = 8;
	string time = 9;
}

///////////////////////////////////////////////////
message UpdateUserRequest {
	string token = 1;
	string name = 2;
	string avatar = 3;
}

message UpdateUserResponse {}


///////////////////////////////////////////////////
message GetClassRequest {
	string token = 1;
}

message GetClassResponse {
	repeated Class classes = 1;
}

message UpdateClassRequest {
	string token = 1;
	repeated Class classes = 2;
}

message UpdateClassResponse {}

message Class {
	int64 id = 1;
	string name = 2;
	string created_by = 3;
}

///////////////////////////////////////////////////
message GetPupilRequest {
	string token = 1;
	string year = 2;
	string class = 3;
}

message GetPupilResponse {
	repeated Pupil pupils = 1;
}

message UpdatePupilRequest {
	string token = 1;
	repeated Pupil pupils = 2;
}

message UpdatePupilResponse {}

message Pupil {
	int64 id = 1;
	string year = 2;
	string class = 3;
	string name = 4;
	string created_by = 5;
}

///////////////////////////////////////////////////
message GetTeacherRequest {
	string token = 1;
	string year = 2;
	string class = 3;
}

message GetTeacherResponse {
	repeated Teacher teachers = 1;
}

message UpdateTeacherRequest {
	string token = 1;
	repeated Teacher teachers = 2;
}

message UpdateTeacherResponse {}

message Teacher {
	int64 id = 1;
	string year = 2;
	string name = 3;
	string class = 4;
	string email = 5;
	string role = 6;
	string created_by = 7;
}

///////////////////////////////////////////////////
message GetAttendanceRequest {
	string token = 1;
	string year = 2;
	string from = 3;
	string to = 4;
	string class = 5;
	string name = 6;
}

message GetAttendanceResponse {
	repeated Attendance attendances = 1;
	repeated Holiday holidays = 3;
}

message UpdateAttendanceRequest {
	string token = 1;
	repeated Attendance attendances = 2;
}

message UpdateAttendanceResponse {}

message Attendance {
	string year = 1;
	string date = 2;
	string class = 3;
	repeated string attendances = 5;
	repeated string absences = 6;
}

message Holiday {
	string date = 1;
	int64 type = 2; // 0: working day | 1: weekend | 2: holiday
}

///////////////////////////////////////////////////
message CountAttendanceRequest {
	string from = 1;
	string to = 2;
	string class = 3;
}

message CountAttendanceResponse {
	int64 sum = 1;
	int64 junior_sum = 2;
	int64 middle_sum = 3;
	int64 senior_sum = 4;
	repeated AttendanceCount attendance_counts = 5;
}

message AttendanceCount {
	string date = 1;
	string class = 2;
	int64 count = 3;
}

// ******************************************************* physique message definition *******************************************************
///////////////////////////////////////////////////
message UpdatePhysiqueRequest {
	string token = 1;
	repeated Physique physiques = 2;
}

message UpdatePhysiqueResponse {}

message Physique {
	int64 id = 1;
	string name = 2;
	string year = 3;
	string class = 4;
	string gender = 5;
	string birth_date = 6;
	string exam_date = 7;
	double height = 8;
	double weight = 9;
	string created_by = 10;

	// requried by response
	string age = 11;
	double age_cmp = 12;
	string height_p = 13;
	string weight_p = 14;
	string height_weight_p = 15;
	double bmi = 16;
	double fat_cofficient = 17;
	string conclusion = 18;
}

///////////////////////////////////////////////////
message GetPhysiqueRequest {
	string token = 1;
	string year = 2;
	string class = 3;
	string name = 4;
}

message GetPhysiqueResponse {
	repeated Physique physiques = 1;
}

message GetAgeHeightWeightPMasterRequest {
	string token = 1;
}

message GetAgeHeightWeightPMasterResponse {
	repeated AgeHeightWeightPMaster masters = 1;
}

message AgeHeightWeightPMaster {
	int64 id = 1;
	string height_or_weight = 2;
	string gender = 3;
	double age_min = 4;
	double age_max = 5;
	double p3 = 6;
	double p10 = 7;
	double p20 = 8;
	double p50 = 9;
	double p80 = 10;
	double p97 = 11;
}

message GetAgeHeightWeightSDMasterRequest {
	string token = 1;
}

message GetAgeHeightWeightSDMasterResponse {
	repeated AgeHeightWeightSDMaster masters = 1;
}

message AgeHeightWeightSDMaster {
	int64 id = 1;
	string height_or_weight = 2;
	string gender = 3;
	string age = 4;
	double sdm2 = 5;
	double sdm1 = 6;
	double avg = 7;
	double sd1 = 8;
	double sd2 = 9;
}

message GetBMIMasterRequest {
	string token = 1;
}

message GetBMIMasterResponse {
	repeated BMIMaster masters = 1;
}

message BMIMaster {
	int64 id = 1;
	string gender = 2;
	string age = 3;
	double avg = 4;
	double sd1 = 5;
	double sd2 = 6;
	double sd3 = 7;
}

message GetHeightToWeightPMasterRequest {
	string token = 1;
}

message GetHeightToWeightPMasterResponse {
	repeated HeightToWeightPMaster masters = 1;
}

message HeightToWeightPMaster {
	int64 id = 1;
	string gender = 2;
	double height = 3;
	double p3 = 4;
	double p10 = 5;
	double p20 = 6;
	double p50 = 7;
	double p80 = 8;
	double p97 = 9;
}

message GetHeightToWeightSDMasterRequest {
	string token = 1;
}

message GetHeightToWeightSDMasterResponse {
	repeated HeightToWeightSDMaster masters = 1;
}

message HeightToWeightSDMaster {
	int64 id = 1;
	string gender = 2;
	double height = 3;
	double sdm3 = 4;
	double sdm2 = 5;
	double sdm1 = 6;
	double sd0 = 7;
	double sd1 = 8;
	double sd2 = 9;
	double sd3 = 10;
}

// ******************************************************* nutrition message definition *******************************************************
///////////////////////////////////////////////////
message GetMenuRequest {
	string token = 1;
	string from = 2;
	string to = 3;
	int64 junior_or_senior = 4;
	int64 breakfast_or_lunch = 5;
}

message GetMenuResponse {
	repeated Menu menus = 1;
}

message UpdateMenuRequest {
	repeated Menu menus = 1;
}

message UpdateMenuResponse {
}

message Menu {
	string date = 1;
	string recipe = 2;
	int64 breakfast_or_lunch = 3;
	int64 junior_or_senior = 4;
}

///////////////////////////////////////////////////
message GetRecipeRequest {
	string token = 1;
	repeated string names = 2;
}

message GetRecipeResponse {
	repeated Recipe recipes = 1;
}

message UpdateRecipeRequest {
	string token = 1;
	repeated Recipe recipes = 2;
}

message UpdateRecipeResponse {
}

message Recipe {
	string recipe = 1;
	repeated Ingredient ingredients = 2;
	double carbohydrate = 3;
	double dietaryfiber = 4;
	double protein = 5;
	double fat = 6;
	double heat = 7;
}

///////////////////////////////////////////////////
message GetIngredientRequest {
	string token = 1;
	repeated string ingredients = 2;
}

message GetIngredientResponse {
	repeated Ingredient ingredients = 1;
}

message GetIngredientNameRequest {
	string pattern = 1;
}

message GetIngredientNameResponse {
	repeated string names = 1;
}

message UpdateIngredientRequest {
	string token = 1;
	repeated Ingredient ingredients = 2;
}

message UpdateIngredientResponse {
}

message Ingredient {
	string ingredient = 1;
	double protein_100g = 2;
	double protein_daily = 3;
	double fat_100g = 4;
	double fat_daily = 5;
	double carbohydrate_100g = 6;
	double carbohydrate_daily = 7;
	double heat_100g = 8;
	double heat_daily = 9;
	double calcium_100g = 10;
	double calcium_daily = 11;
	double iron_100g = 12;
	double iron_daily = 13;
	double zinc_100g = 14;
	double zinc_daily = 15;
	double va_100g = 16;
	double va_daily = 17;
	double vb1_100g = 18;
	double vb1_daily = 19;
	double vb2_100g = 20;
	double vb2_daily = 21;
	double vc_100g = 22;
	double vc_daily = 23;
	string category = 24;
	string alias = 25;
}

///////////////////////////////////////////////////
message GetProcurementRequest {
	string token = 1;
	string from = 2;
	string to = 3;
	int64 meal_id = 4;
}

message GetProcurementResponse {
	repeated Procurement procurements = 1;
}

message Procurement {
	string date = 1;
	int64 attendance = 2;
	repeated IngredientAmount procurement = 3;
}

message IngredientAmount {
	string ingredient = 1;
	double amount = 2;
}

// ******************************************************* growth profile message definition *******************************************************
message GetProfileRequest {
	string token = 1;
	int64 id = 2;
	string year = 3;
	string class = 4;
	string date = 5;
	string name = 6;
}

message GetProfileResponse {
	string profile = 1;
}

message GetPrevOrNextProfileRequest {
	string token = 1;
	string year = 2;
	string class = 3;
	string date = 4;
	string name = 5;
}

message GetPrevOrNextProfileResponse {
	string date = 1;
}

message UpdateProfileRequest {
	string token = 1;
	string year = 2;
	string class = 3;
	string date = 4;
	string name = 5;
	string profile = 6;
	bool enabled = 7;
}

message UpdateProfileResponse {}

message GetProfilesRequest {
	string token = 1;
	string year = 2;
	string class = 3;
	string name = 4;
}

message GetProfilesResponse {
	repeated Profile profiles = 1;
}

message Profile {
	int64 id = 1;
	string year = 2;
	string class = 3;
	string date = 4;
	string name = 5;
}

///////////////////////////////////////////////////
message GetEbooksRequest {
	string token = 1;
	string year = 2;
	string class = 3;
	string name = 4;
	string from = 5;
	string to = 6;
}

message GetEbooksResponse {
	repeated Ebook ebooks = 1;
}

message UpdateEbookRequest {
	string token = 1;
	string year = 2;
	string class = 3;
	string name = 4;
	string date = 5;
	repeated string images = 6;
	string html = 7;
	string css = 8;
}

message UpdateEbookResponse {
}

message Ebook {
	int64 id = 1;
	string year = 2;
	string class = 3;
	string name = 4;
	string date = 5;
}